# 7장. 객체 지향 설계의 달성
## 테스트를 먼저 작성하는 것이 설계에 어떻게 도움이 되는가
호출자 입장에서는  객체가 어떻게 동작하는지보다 무엇을 하는지와 무엇에 의존하는지가 중요하다.

### TDD의 세가지 측면
1. 테스트로 시작하면 어떻게보다 무엇을 달성하고자 하는 지를 먼저 기술한다.
2. 단위테스트를 이해 가능하고 유지보수 가능한 상태로 유지하려면 단위 테스트의 범위를 제한해야 한다(최소단위로)
3. 단위테스트를 하려면 의존성을 전달해야 하는데, 의존성이 어디에 있는지 파악하게 된다. => 대상 객체의 환경을 정리해야 하기 때문에 컨텍스트 독립성이 높아진다.

## 분류보다 의사소통
객체의 의사소통 패턴(프로토콜)이 중요
- 인터페이스 : 두 컴포넌트가 잘 맞는 지 기술
- 프로토콜 : 두 컴포넌트가 함께 동작하는 지 기술
- 목 객체를 활용한 TDD : 통신 프로토콜이 가시성을 띠게 만드는 기법
  - 정보은닉 촉진

## 값 타입
값의 개념을 나타내는 타입을 정의함으로써 해당 타입 자체만으로 설명 가능한 개념이 생겨 일관된 도메인 모델을 만들어 내는 데 도움이 된다.

### 값 타입을 도입하는 기법
- 분해(breaking out) : 어떤 객체의 코드가 복잡해지고 있다면 해당 객체가 다수의 관심사를 표현하고 있을 수 있다. 응집력 있는 행위의 단위로 분해해 helper 타입을 정의하는 것을 고려한다.
- 파생(budding off) : 새로운 도메인 개념을 표시하고 싶을 때 필드가 하나만 있거나 없는 placeholder type 을 도입할 수 있다. 코드 규모가 커짐에 따라 필드와 메서드를 추가해 코드 추상화의 수준을 높인다.
- 포장(bundling up) : 어떤 일련의 값들이 항상 함께 사용된다는 사실을 발견하면, 이 값들을 공용의 타입으로 새로 만들 수 있다.

## 객체 타입의 발견
### 분해 : 큰 객체를 협력 객체의 그룹으로
- 코드가 이해할 수 없을 정도로 너무 복잡해져 정리하고 싶을 때, 응집력 있는 기능 단위를 좀 더 작은 협력 객체로 나누는 작업을 하여 독립적인 단위테스트를 작성
- 이 과정에서 새 객체로 나누는 객체에 대해 의존성을 살펴보게 됨
- 이런 정리 작업을 지연하는 것에 대해 두 가지 고려해보아야 함
   - 작업전 얼마나 기다려야 하는 지 => 정리 작업이 너무 늦어지면 감당이 힘듬
   - 이전에 작성한 코드를 지우고 새로 작성하는 것이 나을 때도 있음
> 테스트 하기가 힘들면 객체가 너무 많은 역할을 가지고 있지 않은 지 생각해보아야 함

### 파생 : 객체가 필요로 하는 신규 서비스 정의, 신규 서비스 객체 추가
- 코드가 어느 정도 구조를 갖추고 나면 새로운 타입을 정의하며 행위를 추가
- 어떤 객체를 구현할 때 새로운 서비스가 필요하다는 사실을 발견하게 되면 새로운 서비스에 이름을 부여하고 그 서비스를 해당 객체의 단위테스트에 목 객체로서 제공하고, 다시 서비스를 제공하는 객체를 작성하는 방식으로 협력 객체의 관계로 구성된 흐름을 따라 작성하게 된다. => 입력에서 출력 방향으로 개발하라

### 포장 : 관련 객체를 포함 객체로 감추기
- 전체는 부분의 합보다 단순해야 한다는 규칙의 응용
- 함께 동작하는 관련 객체의 집합이 있다면, 하나의 객체로 포장할 수 있다 => 추상화 레벨을 올려서 높은 수준의 프로그램 작성

## 인터페이스로 관계 식별
- 인터페이스를 사용해 객체가 수행할 수 있는 역할에 이름을 부여하고 수신할 메시지를 정의한다.
- 인터페이스를 되도록 한정된 범위에서 사용하여 객체의 역할을 명확히 한다.
> 인터페이스의 이름을 Impl 과 같이 짓는 것은 바람직하지 않다. 좀 더 명시적인 이름을 고민하자

## 인터페이스도 리팩터링하라
- 인터페이스가 단일 개념을 표현하는 지, 병합될 수 있는 지 살펴야 한다
- 인터페이스를 구현하기 시작할 때 클래스의 구조가 불분명하다면 해당 인터페이스가 가진 책임이 너무 많은 것일 수 있다.